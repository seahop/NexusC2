[websocket]
port = "3131"
cert_file = "/app/certs/ws_server.crt"
key_file = "/app/certs/ws_server.key"

[web_server]
cert_file = "/app/certs/web_server.crt"
key_file = "/app/certs/web_server.key"

[rpc_server]
cert_file = "/app/certs/rpc_server.crt"
key_file = "/app/certs/rpc_server.key"

[redirect_site]
url = "https://google.com"

# GET-type handler with custom method PUT
[[http_routes.get_handlers]]
path = "/api/v1/myget"
method = "PUT"  # Custom HTTP verb - defaults to "GET" if not specified
enabled = true
auth_required = true
[[http_routes.get_handlers.params]]
name = "client"
type = "clientID_param"
format = "%CLIENTID%"

# POST-type handler with custom method BLAH
[[http_routes.post_handlers]]
path = "/api/v1/mypost"
method = "BLAH"  # Custom HTTP verb - defaults to "POST" if not specified
enabled = true
auth_required = true
[[http_routes.post_handlers.params]]
name = "client"
type = "clientID_param"
format = "%CLIENTID%"

# You can add more handlers with different custom methods
# [[http_routes.get_handlers]]
# path = "/api/v1/status"
# method = "HEAD"
# enabled = true
# auth_required = false

# [[http_routes.post_handlers]]
# path = "/api/v1/update"
# method = "PATCH"
# enabled = true
# auth_required = true

[server_headers]
server = "nginx/1.18.0"
strict_transport_security = "max-age=31536000; includeSubDomains"
x_frame_options = "DENY"
x_content_type_options = "nosniff"

[payload_config]
sleep = 20
jitter = 10

# Malleable command values - customize these to avoid detection signatures
[payload_config.malleable_commands]
# The value that will replace 'rekey' in cleartext communication
# Agent will be compiled to recognize this value as the rekey command
# Change this to any value to remove 'rekey' signature from network traffic and binary
rekey = "bloop"

# JSON field names for rekey response - customize to avoid structural fingerprinting
# These control the field names in the JSON response sent over the wire
# Default: {"status": "bloop", "data": "", "command_db_id": 1}
# Custom:  {"x": "bloop", "y": "", "z": 1}
rekey_status_field = "status"
rekey_data_field = "data"
rekey_id_field = "id"

[payload_config.http_headers]
user_agent = "Mozilla/5.0 (Windows NT 10.0; Win64; x64)"
content_type = "application/json"

[[payload_config.http_headers.custom_headers]]
name = "X-Custom-Header"
value = "custom-value"
[[payload_config.http_headers.custom_headers]]
name = "X-Forward-For"
value = "127.0.0.1"
[[payload_config.http_headers.custom_headers]]
name = "Accept"
value = "*/*"
[[payload_config.http_headers.custom_headers]]
name = "Accept-Language"
value = "en-US,en;q=0.9"
[[payload_config.http_headers.custom_headers]]
name = "Connection"
value = "close"